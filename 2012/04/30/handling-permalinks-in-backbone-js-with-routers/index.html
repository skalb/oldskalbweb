
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Handling permalinks in Backbone.js with Routers - skalb.com</title>
  <meta name="author" content="Sameer Kalburgi">

   
  <meta name="description" content="">
  
  <meta name="keywords" content="">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.skalb.com/2012/04/30/handling-permalinks-in-backbone-js-with-routers">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/skalb" rel="alternate" title="skalb.com" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <script src="/js/application.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19284849-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
    
        <li ><a href="/index.html">skalb.com</a></li>
    
        <li ><a href="/blog/archives/index.html">Archives</a></li>
    
        <li ><a href="https://github.com/skalb/skalb.github.com/tree/source">Source</a></li>
    
</ul>

<ul class="nav pull-right">
    
    <li><a href="http://github.com/skalb" title="Github Profile"><i class="icon-github-sign social-navbar"></i></a></li>
    
    
    
    <li><a href="http://linkedin.com/in/sameerkalburgi" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://twitter.com/sameerkalburgi" title="Twitter Profile"><i class="icon-twitter-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://plus.google.com/100596472903145614776" title="Google+ Profile"><i class="icon-google-plus-sign social-navbar"></i></a></li>
    
    
    

    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    Handling Permalinks in Backbone.js With Routers
	<h5>








  


<i class="icon-calendar-empty"></i> <time datetime="2012-04-30T00:00:00-07:00" pubdate data-updated="true">Apr 30<span>th</span>, 2012</time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>This post is part of a series:</p>

<ul>
<li><a href="http://www.skalb.com/2012/04/23/how-to-easily-handle-model-relationships-in-rails-and-backbone-js/">First post</a></li></li>
<li><a href="http://www.skalb.com/2012/04/26/extending-and-refactoring-views-in-backbone/">Second post</a></li></li>
</ul>


<p>One of the missing features in my prototype was handling of permalinks. To make things easy, I originally removed all the routes and added click handlers instead. In retrospect that was a mistake. Instead of having the app logic tangled up with click handlers, it would have been much more straightforward to define routes and use links.</p>

<p>Here’s the <a href="http://young-flower-9677.herokuapp.com/">demo</a> and <a href="https://github.com/skalb/trackbone">source</a></p>

<!--more-->


<p>In this post, I’m going to explain the  Backbone router step by step. First, I need to actually define what routes I want:</p>

<p>I need:</p>

<ul>
<li>Home page &ndash;> Load list of projects</li></li>
<li>Selected project &ndash;> Load list of projects and features</li></li>
<li>Selected feature &ndash;> Load list of projects, features, and bugs</li></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">routes:</span>
</span><span class='line'>  <span class="s">&quot;.*&quot;</span> <span class="err"> </span><span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>  <span class="s">&quot;projects/:project_id&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>  <span class="s">&quot;projects/:project_id/features/:feature_id/*&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that all my routes point to the same function. The only difference is that the project_id and feature_id variables will be undefined. JavaScript won’t complain if your function call doesn’t match the function signature. It will just set them undefined.</p>

<p>Now let’s look at showProjects.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">showProjects: </span><span class="nf">(project_id, feature_id, bug_id) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="s">&quot;Projects&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="k">if</span> <span class="nx">project_id</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="p">[</span><span class="nx">feature_id</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">],</span> <span class="s">&quot;loadFeatures&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>My original goal was to create a helper method that would support an abitrary length chain of loading children. That is, loadChildren will call loadFeatures which will then call loadChildren again etc. The final implementation isn’t quite that generic since it requires me to construct the individual item_ids at the start.</p>

<p>As I was finishing this prototype , I managed to remove all duplicate code by creating some helper methods.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">clearType: </span><span class="nf">(model) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">renderView: </span><span class="nf">(selector, view) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">renderViews: </span><span class="nf">(items, item_id, type) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">indexView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">IndexView</span><span class="p">(</span><span class="nv">items: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">item_id</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">indexView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">newView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">NewView</span><span class="p">(</span><span class="nv">collection: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">newView</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And now let’s look at loadChildren:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">loadChildren: </span><span class="nf">(items, item_id, child_ids, callback) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">item = </span><span class="nx">items</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">item_id</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">loadChildren</span><span class="p">()</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
</span><span class='line'> <span class="err">   </span><span class="nv">success: </span><span class="o">=&gt;</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@</span><span class="p">[</span><span class="nx">callback</span><span class="p">](</span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="nx">child_ids</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Okay, why am I indexing into the object with a string instead of just passing the function in directly. Well, because the fat arrow wasn’t working as expected. Either I was doing something wrong or there&rsquo;s a bug in the coffee-rails interpreter because js2coffee gave me a different result.</p>

<p>The full router:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="k">class</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Routers</span><span class="p">.</span><span class="nx">ProjectsRouter</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span>
</span><span class='line'> <span class="err"> </span><span class="nv">initialize: </span><span class="nf">(options) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="vi">@projects = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">ProjectsCollection</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@projects</span><span class="p">.</span><span class="nx">reset</span> <span class="nx">options</span><span class="p">.</span><span class="nx">projects</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">routes:</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;.*&quot;</span> <span class="err"> </span><span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;projects/:project_id&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;projects/:project_id/features/:feature_id/*&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">clearType: </span><span class="nf">(model) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadChildren: </span><span class="nf">(items, item_id, child_ids, callback) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">item = </span><span class="nx">items</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">item_id</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">loadChildren</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
</span><span class='line'> <span class="err">     </span><span class="nv">success: </span><span class="o">=&gt;</span>
</span><span class='line'> <span class="err">       </span><span class="nx">@</span><span class="p">[</span><span class="nx">callback</span><span class="p">](</span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="nx">child_ids</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">renderView: </span><span class="nf">(selector, view) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">renderViews: </span><span class="nf">(items, item_id, type) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">indexView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">IndexView</span><span class="p">(</span><span class="nv">items: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">item_id</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">indexView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="nv">newView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">NewView</span><span class="p">(</span><span class="nv">collection: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">newView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">showProjects: </span><span class="nf">(project_id, feature_id, bug_id) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="s">&quot;Projects&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="nx">project_id</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="p">[</span><span class="nx">feature_id</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">],</span> <span class="s">&quot;loadFeatures&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadFeatures: </span><span class="nf">(features, feature_id, child_ids) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">features</span><span class="p">,</span> <span class="nx">feature_id</span><span class="p">,</span> <span class="s">&quot;Features&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="nx">feature_id</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">features</span><span class="p">,</span> <span class="nx">feature_id</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">,</span> <span class="s">&quot;loadBugs&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="k">else</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@clearType</span><span class="p">(</span><span class="s">&quot;bugs&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadBugs: </span><span class="nf">(bugs, bug_id, child_ids) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">bugs</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">,</span> <span class="s">&quot;Bugs&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I also needed to tweak my item view to include the correct url for the select link.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">Projects</span> <span class="o">||=</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">ItemView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>
</span><span class='line'> <span class="err"> </span><span class="nv">template: </span><span class="nx">JST</span><span class="p">[</span><span class="s">&quot;backbone/templates/item&quot;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">events:</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;click .destroy&quot;</span> <span class="o">:</span> <span class="s">&quot;destroy&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">tagName: </span><span class="s">&quot;tr&quot;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">className: </span><span class="s">&quot;item&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">destroy: </span><span class="p">()</span> <span class="nf">-&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@model</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">render: </span><span class="nf">-&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">name = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nv">id = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nv">url = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">url</span><span class="p">()</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="nx">@el</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@template</span><span class="p">(</span><span class="nv">name: </span><span class="nx">name</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">id</span><span class="p">,</span> <span class="nv">url: </span><span class="nx">url</span><span class="p">))</span>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="p">(</span><span class="nx">@options</span><span class="p">.</span><span class="nx">selected</span><span class="p">)</span>
</span><span class='line'> <span class="err">     </span><span class="nb">window</span><span class="p">.</span><span class="nx">toggleSelected</span><span class="p">(</span><span class="nx">@el</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="k">return</span> <span class="k">this</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, here’s the <a href="http://young-flower-9677.herokuapp.com/">demo</a> and <a href="https://github.com/skalb/trackbone">source</a></p>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        



  <a href="/categories/backbone/"><span class="badge">Backbone</span></a>

  <a href="/categories/coffeescript/"><span class="badge">CoffeeScript</span></a>

  <a href="/categories/rails/"><span class="badge">Rails</span></a>




        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/2012/04/26/extending-and-refactoring-views-in-backbone/" title="Previous Post: Extending and refactoring views in Backbone.js">&laquo; Extending and refactoring views in Backbone.js</a>
          
          
            <a class="basic-alignment right" href="/2012/05/02/book-review-technical-blogging/" title="Next Post: Book Review: Technical Blogging">Book Review: Technical Blogging &raquo;</a>
          
        </p>
      </div>
    </div>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2014 - Sameer Kalburgi -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'skalb';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.skalb.com/2012/04/30/handling-permalinks-in-backbone-js-with-routers/';
        var disqus_url = 'http://www.skalb.com/2012/04/30/handling-permalinks-in-backbone-js-with-routers/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
