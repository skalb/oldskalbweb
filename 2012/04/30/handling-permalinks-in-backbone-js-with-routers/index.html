
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Handling permalinks in Backbone.js with Routers - skalb.com</title>
	<meta name="author" content="Sameer Kalburgi">

	
	<meta name="description" content="This post is part of a series: First post Second post One of the missing features in my prototype was handling of permalinks. To make things easy, I &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="http://feeds.feedburner.com/skalb" rel="alternate" title="skalb.com" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">skalb.com</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
  <li><a href="https://github.com/skalb/skalb.github.com/tree/source">Blog Source</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
  <li><a href="https://github.com/skalb/skalb.github.com/tree/source">Blog Source</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:www.skalb.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/100596472903145614776?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/sameerkalburgi" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/skalb" title="GitHub">GitHub</a>
		
    
		
		<a class="coderwall" href="https://coderwall.com/skalb" title="Coderwall">Coderwall</a>
		
		
		
		
		
		<a class="rss" href="http://feeds.feedburner.com/skalb" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.skalb.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Handling Permalinks in Backbone.js With Routers</h2>
	<div class="entry-content"><p>This post is part of a series:</p>

<ul>
    <li><a title="How to (easily) handle model relationships in Rails and Backbone.js" href="http://www.skalb.com/2012/04/23/how-to-easily-handle-model-relationships-in-rails-and-backbone-js/">First post</a></li>
    <li><a title="Extending and refactoring views in Backbone.js" href="http://www.skalb.com/2012/04/26/extending-and-refactoring-views-in-backbone/">Second post</a></li>
</ul>


<p>One of the missing features in my prototype was handling of permalinks. To make things easy, I originally removed all the routes and added click handlers instead. In retrospect that was a mistake. Instead of having the app logic tangled up with click handlers, it would have been much more straightforward to define routes and use links.</p>

<p>Here’s the <a href="https://github.com/skalb/trackbone">source</a> and <a href="http://young-flower-9677.herokuapp.com/">demo</a>.</p>

<!--more-->


<p>In this post, I’m going to explain the  Backbone router step by step. First, I need to actually define what routes I want:</p>

<p>I need:</p>

<ul>
    <li>Home page -> Load list of projects</li>
    <li>Selected project -> Load list of projects and features</li>
    <li>Selected feature -> Load list of projects, features, and bugs</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">routes:</span>
</span><span class='line'>  <span class="s">&quot;.*&quot;</span> <span class="err"> </span><span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>  <span class="s">&quot;projects/:project_id&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>  <span class="s">&quot;projects/:project_id/features/:feature_id/*&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that all my routes point to the same function. The only difference is that the project_id and feature_id variables will be undefined. JavaScript won’t complain if your function call doesn’t match the function signature. It will just set them undefined.</p>

<p>Now let’s look at showProjects.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">showProjects: </span><span class="nf">(project_id, feature_id, bug_id) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="s">&quot;Projects&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="k">if</span> <span class="nx">project_id</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="p">[</span><span class="nx">feature_id</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">],</span> <span class="s">&quot;loadFeatures&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>My original goal was to create a helper method that would support an abitrary length chain of loading children. That is, loadChildren will call loadFeatures which will then call loadChildren again etc. The final implementation isn’t quite that generic since it requires me to construct the individual item_ids at the start.</p>

<p>As I was finishing this prototype , I managed to remove all duplicate code by creating some helper methods.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">clearType: </span><span class="nf">(model) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">renderView: </span><span class="nf">(selector, view) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">renderViews: </span><span class="nf">(items, item_id, type) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">indexView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">IndexView</span><span class="p">(</span><span class="nv">items: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">item_id</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">indexView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">newView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">NewView</span><span class="p">(</span><span class="nv">collection: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">newView</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>And now let’s look at loadChildren:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">loadChildren: </span><span class="nf">(items, item_id, child_ids, callback) -&gt;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">item = </span><span class="nx">items</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">item_id</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">loadChildren</span><span class="p">()</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
</span><span class='line'> <span class="err">   </span><span class="nv">success: </span><span class="o">=&gt;</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@</span><span class="p">[</span><span class="nx">callback</span><span class="p">](</span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="nx">child_ids</span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="p">)</span>
</span><span class='line'> <span class="err"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Okay, why am I indexing into the object with a string instead of just passing the function in directly. Well, because the fat arrow wasn’t working as expected. Either I was doing something wrong or there&#8217;s a bug in the coffee-rails interpreter because js2coffee gave me a different result.</p>

<p>The full router:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="k">class</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Routers</span><span class="p">.</span><span class="nx">ProjectsRouter</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span>
</span><span class='line'> <span class="err"> </span><span class="nv">initialize: </span><span class="nf">(options) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="vi">@projects = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">ProjectsCollection</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@projects</span><span class="p">.</span><span class="nx">reset</span> <span class="nx">options</span><span class="p">.</span><span class="nx">projects</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">routes:</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;.*&quot;</span> <span class="err"> </span><span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;projects/:project_id&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;projects/:project_id/features/:feature_id/*&quot;</span> <span class="o">:</span> <span class="s">&quot;showProjects&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">clearType: </span><span class="nf">(model) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">model</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadChildren: </span><span class="nf">(items, item_id, child_ids, callback) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">item = </span><span class="nx">items</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">item_id</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">loadChildren</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
</span><span class='line'> <span class="err">     </span><span class="nv">success: </span><span class="o">=&gt;</span>
</span><span class='line'> <span class="err">       </span><span class="nx">@</span><span class="p">[</span><span class="nx">callback</span><span class="p">](</span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="nx">child_ids</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">item</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">fetch</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">renderView: </span><span class="nf">(selector, view) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">renderViews: </span><span class="nf">(items, item_id, type) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">indexView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">IndexView</span><span class="p">(</span><span class="nv">items: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">item_id</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">list-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">indexView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="nv">newView = </span><span class="k">new</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">NewView</span><span class="p">(</span><span class="nv">collection: </span><span class="nx">items</span><span class="p">,</span> <span class="nv">type: </span><span class="nx">type</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderView</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">new-</span><span class="si">#{</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">newView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">showProjects: </span><span class="nf">(project_id, feature_id, bug_id) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="s">&quot;Projects&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="nx">project_id</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">@projects</span><span class="p">,</span> <span class="nx">project_id</span><span class="p">,</span> <span class="p">[</span><span class="nx">feature_id</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">],</span> <span class="s">&quot;loadFeatures&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadFeatures: </span><span class="nf">(features, feature_id, child_ids) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">features</span><span class="p">,</span> <span class="nx">feature_id</span><span class="p">,</span> <span class="s">&quot;Features&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="nx">feature_id</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@loadChildren</span><span class="p">(</span><span class="nx">features</span><span class="p">,</span> <span class="nx">feature_id</span><span class="p">,</span> <span class="nx">child_ids</span><span class="p">,</span> <span class="s">&quot;loadBugs&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="k">else</span>
</span><span class='line'> <span class="err">     </span><span class="nx">@clearType</span><span class="p">(</span><span class="s">&quot;bugs&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">loadBugs: </span><span class="nf">(bugs, bug_id, child_ids) -&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@renderViews</span><span class="p">(</span><span class="nx">bugs</span><span class="p">,</span> <span class="nx">bug_id</span><span class="p">,</span> <span class="s">&quot;Bugs&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I also needed to tweak my item view to include the correct url for the select link.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">Projects</span> <span class="o">||=</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nx">Trackbone</span><span class="p">.</span><span class="nx">Views</span><span class="p">.</span><span class="nx">ItemView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>
</span><span class='line'> <span class="err"> </span><span class="nv">template: </span><span class="nx">JST</span><span class="p">[</span><span class="s">&quot;backbone/templates/item&quot;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">events:</span>
</span><span class='line'> <span class="err">   </span><span class="s">&quot;click .destroy&quot;</span> <span class="o">:</span> <span class="s">&quot;destroy&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">tagName: </span><span class="s">&quot;tr&quot;</span>
</span><span class='line'> <span class="err"> </span><span class="nv">className: </span><span class="s">&quot;item&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">destroy: </span><span class="p">()</span> <span class="nf">-&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">@model</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>
</span><span class='line'> <span class="err">   </span><span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'> <span class="err">   </span><span class="k">return</span> <span class="kc">false</span>
</span><span class='line'>
</span><span class='line'> <span class="err"> </span><span class="nv">render: </span><span class="nf">-&gt;</span>
</span><span class='line'> <span class="err">   </span><span class="nv">name = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nv">id = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="nv">url = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">url</span><span class="p">()</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'> <span class="err">   </span><span class="nx">$</span><span class="p">(</span><span class="nx">@el</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@template</span><span class="p">(</span><span class="nv">name: </span><span class="nx">name</span><span class="p">,</span> <span class="nv">id: </span><span class="nx">id</span><span class="p">,</span> <span class="nv">url: </span><span class="nx">url</span><span class="p">))</span>
</span><span class='line'> <span class="err">   </span><span class="k">if</span> <span class="p">(</span><span class="nx">@options</span><span class="p">.</span><span class="nx">selected</span><span class="p">)</span>
</span><span class='line'> <span class="err">     </span><span class="nb">window</span><span class="p">.</span><span class="nx">toggleSelected</span><span class="p">(</span><span class="nx">@el</span><span class="p">)</span>
</span><span class='line'> <span class="err">   </span><span class="k">return</span> <span class="k">this</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, here’s the <a href="https://github.com/skalb/trackbone">source</a> and <a href="http://young-flower-9677.herokuapp.com/">demo</a>.</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-04-30T00:00:00-07:00" pubdate data-updated="true">Apr 30<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/backbone/'>Backbone</a>, <a class='category' href='/categories/coffeescript/'>CoffeeScript</a>, <a class='category' href='/categories/rails/'>Rails</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
		
		
		<a class="addthis_button_tweet"></a>
		
		
		<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
		
		
	</div>
	
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Sameer Kalburgi

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'skalb';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.skalb.com/2012/04/30/handling-permalinks-in-backbone-js-with-routers/';
        var disqus_url = 'http://www.skalb.com/2012/04/30/handling-permalinks-in-backbone-js-with-routers/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-19284849-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>